<% content_for :page_links do %>
  <%= link_to 'New Fixture', new_my_fifa_fixture_path, class: 'ui basic primary button' %>
<% end %>

<table class="ui basic sortable definition selectable compact small table" data-link="/my_fifa/fixtures/" width="100%">
  <thead>
    <tr>
      <% ['Opponent Team', 'Competition', 'Score', 'MOTM', 'Date Played'].each do |header| %>
        <th><%= header %></th>
      <% end %>
    </tr>
  </thead>
</table>

<script>
  $(function(){
    $('table').DataTable({
      processing: true,      
      ajax: '/my_fifa/fixtures',
      order: [[4, 'desc']],
      columns: [
        { data: 'opponent' },
        { data: 'competition' },
        { data: 'score', searchable: false, sortable: false },
        { data: 'motm' },
        { data: { _: 'date_played', sort: 'timestamp' }, searchable: false },
      ],
      createdRow: function(nRow, aData){
        $.each(['Competition', 'Score', 'MOTM', 'Date Played'], function(i, label){
          $('td:nth-child('+(i+2)+')', $(nRow)).prepend(labeledData(label, ''));
        });
        $(nRow)
          .data('id', aData.id)
          .addClass(aData.result);
      }
    });    
  });

  function labeledData(label, data){
    return "<div class=\"ui responsive basic right pointing label\">"+label+"</div>"+data;
  }
</script>